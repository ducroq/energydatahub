2025-10-25 19:57:02,946 DEBUG Using selector: EpollSelector
2025-10-25 19:57:02,946 INFO Output directory ensured: /home/runner/work/energydatahub/energydatahub/data
2025-10-25 19:57:04,135 INFO No secrets.ini found, using environment variables only
2025-10-25 19:57:04,136 DEBUG Overriding security_keys.encryption from environment variable ENCRYPTION_KEY
2025-10-25 19:57:04,136 DEBUG Overriding security_keys.hmac from environment variable HMAC_KEY
2025-10-25 19:57:04,136 DEBUG Overriding api_keys.entsoe from environment variable ENTSOE_API_KEY
2025-10-25 19:57:04,136 DEBUG Overriding api_keys.openweather from environment variable OPENWEATHER_API_KEY
2025-10-25 19:57:04,136 DEBUG Overriding api_keys.meteo from environment variable METEO_API_KEY
2025-10-25 19:57:04,136 DEBUG Overriding api_keys.google from environment variable GOOGLE_API_KEY
2025-10-25 19:57:04,136 INFO [c08258d4] Starting collection: 2025-10-25 21:57:04.136517+02:00 to 2025-10-26 20:57:04.136517+01:00
2025-10-25 19:57:04,136 DEBUG [c08258d4] Fetching raw data...
2025-10-25 19:57:04,137 DEBUG Attempt 1/3
2025-10-25 19:57:04,137 DEBUG Fetching ENTSO-E data for NL
2025-10-25 19:57:04,137 DEBUG Querying ENTSO-E API: 2025-10-25 19:57:04.136517+00:00 to 2025-10-26 19:57:04.136517+00:00 (UTC)
2025-10-25 19:57:04,147 DEBUG Performing request to https://web-api.tp.entsoe.eu/api with params {'documentType': 'A44', 'in_Domain': '10YNL----------L', 'out_Domain': '10YNL----------L', 'offset': 0, 'contract_MarketAgreement.type': 'A01', 'securityToken': 'e764dd40-0108-4de7-81e7-b32f7fa55d69', 'periodStart': '202510242000', 'periodEnd': '202510272000'}
2025-10-25 19:57:04,149 INFO [85af38a6] Starting collection: 2025-10-25 21:57:04.136517+02:00 to 2025-10-26 20:57:04.136517+01:00
2025-10-25 19:57:04,149 DEBUG Starting new HTTPS connection (1): web-api.tp.entsoe.eu:443
2025-10-25 19:57:04,149 DEBUG [85af38a6] Fetching raw data...
2025-10-25 19:57:04,150 DEBUG Attempt 1/3
2025-10-25 19:57:04,150 DEBUG Fetching EnergyZero data
2025-10-25 19:57:04,150 WARNING Attempt 1 failed: TypeError: EnergyZero.__init__() got an unexpected keyword argument 'vat'
2025-10-25 19:57:04,150 INFO Retrying in 0.76 seconds...
2025-10-25 19:57:04,150 INFO [fcea7281] Starting collection: 2025-10-25 21:57:04.136517+02:00 to 2025-10-26 20:57:04.136517+01:00
2025-10-25 19:57:04,150 DEBUG [fcea7281] Fetching raw data...
2025-10-25 19:57:04,150 DEBUG Attempt 1/3
2025-10-25 19:57:04,150 DEBUG Fetching EPEX data from Awattar API
2025-10-25 19:57:04,151 INFO [e7570bc8] Starting collection: 2025-10-25 21:57:04.136517+02:00 to 2025-10-26 20:57:04.136517+01:00
2025-10-25 19:57:04,151 DEBUG Attempt 1/3
2025-10-25 19:57:04,152 DEBUG Fetching OpenWeather data for lat=51.966472, lon=5.94009
2025-10-25 19:57:04,152 INFO [eedf51dc] Starting collection: 2025-10-25 21:57:04.136517+02:00 to 2025-10-26 20:57:04.136517+01:00
2025-10-25 19:57:04,152 DEBUG [eedf51dc] Fetching raw data...
2025-10-25 19:57:04,153 DEBUG Attempt 1/10
2025-10-25 19:57:04,153 DEBUG Fetching MeteoServer weather for lat=51.966472, lon=5.94009
2025-10-25 19:57:04,153 INFO [cab2b126] Starting collection: 2025-10-25 21:57:04.136517+02:00 to 2025-10-26 20:57:04.136517+01:00
2025-10-25 19:57:04,153 DEBUG [cab2b126] Fetching raw data...
2025-10-25 19:57:04,153 DEBUG Attempt 1/10
2025-10-25 19:57:04,154 DEBUG Fetching MeteoServer sun forecast for lat=51.966472, lon=5.94009
2025-10-25 19:57:04,154 INFO [e960d2d1] Starting collection: 2025-10-25 21:57:04.136517+02:00 to 2025-10-26 20:57:04.136517+01:00
2025-10-25 19:57:04,154 DEBUG [e960d2d1] Fetching raw data...
2025-10-25 19:57:04,154 DEBUG Attempt 1/3
2025-10-25 19:57:04,154 DEBUG Fetching Elspot data for NL
2025-10-25 19:57:04,155 INFO [f19a8e94] Starting collection: 2025-10-24 21:57:04.136517+02:00 to 2025-10-25 21:57:04.136517+02:00
2025-10-25 19:57:04,156 DEBUG [f19a8e94] Fetching raw data...
2025-10-25 19:57:04,156 DEBUG Attempt 1/3
2025-10-25 19:57:04,156 DEBUG Fetching Luchtmeetnet data for lat=51.966472, lon=5.94009
2025-10-25 19:57:04,156 INFO Station cache miss or expired, fetching fresh data
2025-10-25 19:57:04,156 DEBUG Fetching station list
2025-10-25 19:57:04,156 DEBUG Starting new HTTPS connection (1): dataportal-api.nordpoolgroup.com:443
2025-10-25 19:57:04,313 DEBUG Parsed 8 data points from OpenWeather response
2025-10-25 19:57:04,314 INFO [e7570bc8] Collection complete: 8 data points in 0.16s (status: success)
2025-10-25 19:57:04,481 DEBUG [fcea7281] Parsing response...
2025-10-25 19:57:04,481 DEBUG Parsed 23 data points from Awattar response
2025-10-25 19:57:04,481 DEBUG [fcea7281] Normalizing timestamps...
2025-10-25 19:57:04,481 DEBUG [fcea7281] Validating data...
2025-10-25 19:57:04,482 INFO [fcea7281] Collection complete: 23 data points in 0.33s (status: success)
2025-10-25 19:57:04,500 DEBUG https://dataportal-api.nordpoolgroup.com:443 "GET /api/DayAheadPriceIndices?currency=EUR&market=DayAhead&date=2025-10-26&resolutionInMinutes=60&indexNames=NL HTTP/1.1" 200 None
2025-10-25 19:57:04,507 DEBUG [e960d2d1] Parsing response...
2025-10-25 19:57:04,508 DEBUG Parsed 22 data points from Elspot response
2025-10-25 19:57:04,508 DEBUG [e960d2d1] Normalizing timestamps...
2025-10-25 19:57:04,508 DEBUG [e960d2d1] Validating data...
2025-10-25 19:57:04,508 INFO [e960d2d1] Collection complete: 22 data points in 0.35s (status: success)
2025-10-25 19:57:04,684 DEBUG https://web-api.tp.entsoe.eu:443 "GET /api?documentType=A44&in_Domain=10YNL----------L&out_Domain=10YNL----------L&offset=0&contract_MarketAgreement.type=A01&securityToken=e764dd40-0108-4de7-81e7-b32f7fa55d69&periodStart=202510242000&periodEnd=202510272000 HTTP/1.1" 200 None
2025-10-25 19:57:04,859 DEBUG [eedf51dc] Parsing response...
2025-10-25 19:57:04,859 DEBUG Parsed 24 data points from MeteoServer weather response
2025-10-25 19:57:04,859 DEBUG [eedf51dc] Normalizing timestamps...
2025-10-25 19:57:04,859 DEBUG [eedf51dc] Validating data...
2025-10-25 19:57:04,861 INFO [eedf51dc] Collection complete: 24 data points in 0.71s (status: success)
2025-10-25 19:57:04,906 DEBUG Performing request to https://web-api.tp.entsoe.eu/api with params {'documentType': 'A44', 'in_Domain': '10YNL----------L', 'out_Domain': '10YNL----------L', 'offset': 100, 'contract_MarketAgreement.type': 'A01', 'securityToken': 'e764dd40-0108-4de7-81e7-b32f7fa55d69', 'periodStart': '202510242000', 'periodEnd': '202510272000'}
2025-10-25 19:57:04,907 DEBUG Attempt 2/3
2025-10-25 19:57:04,908 DEBUG Fetching EnergyZero data
2025-10-25 19:57:04,908 WARNING Attempt 2 failed: TypeError: EnergyZero.__init__() got an unexpected keyword argument 'vat'
2025-10-25 19:57:04,908 INFO Retrying in 1.46 seconds...
2025-10-25 19:57:05,058 DEBUG [cab2b126] Parsing response...
2025-10-25 19:57:05,059 DEBUG Parsed 24 data points from MeteoServer sun response
2025-10-25 19:57:05,059 DEBUG [cab2b126] Normalizing timestamps...
2025-10-25 19:57:05,059 DEBUG [cab2b126] Validating data...
2025-10-25 19:57:05,060 INFO [cab2b126] Collection complete: 24 data points in 0.91s (status: success)
2025-10-25 19:57:05,112 DEBUG https://web-api.tp.entsoe.eu:443 "GET /api?documentType=A44&in_Domain=10YNL----------L&out_Domain=10YNL----------L&offset=100&contract_MarketAgreement.type=A01&securityToken=e764dd40-0108-4de7-81e7-b32f7fa55d69&periodStart=202510242000&periodEnd=202510272000 HTTP/1.1" 200 933
2025-10-25 19:57:05,118 DEBUG Encoding detection: utf_8 is most likely the one.
2025-10-25 19:57:05,118 DEBUG NoMatchingDataError: for offset 100
2025-10-25 19:57:05,120 DEBUG [c08258d4] Parsing response...
2025-10-25 19:57:05,121 DEBUG Parsed 96 data points from ENTSO-E response
2025-10-25 19:57:05,121 DEBUG [c08258d4] Normalizing timestamps...
2025-10-25 19:57:05,122 DEBUG [c08258d4] Validating data...
2025-10-25 19:57:05,122 INFO [c08258d4] Collection complete: 96 data points in 0.99s (status: success)
2025-10-25 19:57:06,373 DEBUG Attempt 3/3
2025-10-25 19:57:06,373 DEBUG Fetching EnergyZero data
2025-10-25 19:57:06,373 WARNING Attempt 3 failed: TypeError: EnergyZero.__init__() got an unexpected keyword argument 'vat'
2025-10-25 19:57:06,374 ERROR All 3 attempts failed. Last error: TypeError: EnergyZero.__init__() got an unexpected keyword argument 'vat'
2025-10-25 19:57:06,374 ERROR [85af38a6] Collection failed after 2.23s: EnergyZero.__init__() got an unexpected keyword argument 'vat'
2025-10-25 19:57:06,438 DEBUG Found 101 stations, fetching details...
2025-10-25 19:57:40,290 INFO Cached 101 stations
2025-10-25 19:57:40,290 INFO Using station NL54004 (Arnhem Velperbroek)
2025-10-25 19:57:40,290 DEBUG Fetching AQI for station NL54004
2025-10-25 19:57:41,199 DEBUG Fetching measurements for station NL54004
2025-10-25 19:57:41,631 DEBUG [f19a8e94] Parsing response...
2025-10-25 19:57:41,634 DEBUG Parsed 23 data points from Luchtmeetnet response
2025-10-25 19:57:41,634 DEBUG [f19a8e94] Normalizing timestamps...
2025-10-25 19:57:41,634 DEBUG [f19a8e94] Validating data...
2025-10-25 19:57:41,634 INFO [f19a8e94] Collection complete: 23 data points in 37.48s (status: success)
2025-10-25 19:57:41,635 INFO Timestamp validation passed - all timestamps correctly formatted
2025-10-25 19:57:41,642 INFO Timestamp validation passed - all timestamps correctly formatted
2025-10-25 19:57:41,643 INFO Timestamp validation passed - all timestamps correctly formatted
2025-10-25 19:57:41,644 INFO Timestamp validation passed - all timestamps correctly formatted
