2025-10-25 18:56:35,644 DEBUG Using selector: EpollSelector
2025-10-25 18:56:35,644 INFO Output directory ensured: /home/runner/work/energydatahub/energydatahub/data
2025-10-25 18:56:36,793 INFO No secrets.ini found, using environment variables only
2025-10-25 18:56:36,793 DEBUG Overriding security_keys.encryption from environment variable ENCRYPTION_KEY
2025-10-25 18:56:36,793 DEBUG Overriding security_keys.hmac from environment variable HMAC_KEY
2025-10-25 18:56:36,793 DEBUG Overriding api_keys.entsoe from environment variable ENTSOE_API_KEY
2025-10-25 18:56:36,793 DEBUG Overriding api_keys.openweather from environment variable OPENWEATHER_API_KEY
2025-10-25 18:56:36,793 DEBUG Overriding api_keys.meteo from environment variable METEO_API_KEY
2025-10-25 18:56:36,793 DEBUG Overriding api_keys.google from environment variable GOOGLE_API_KEY
2025-10-25 18:56:36,794 INFO [c1cbb326] Starting collection: 2025-10-25 20:56:36.793824+02:00 to 2025-10-26 19:56:36.793824+01:00
2025-10-25 18:56:36,794 DEBUG [c1cbb326] Fetching raw data...
2025-10-25 18:56:36,794 DEBUG Attempt 1/3
2025-10-25 18:56:36,794 DEBUG Fetching ENTSO-E data for NL
2025-10-25 18:56:36,794 DEBUG Querying ENTSO-E API: 2025-10-25 18:56:36.793824+00:00 to 2025-10-26 18:56:36.793824+00:00 (UTC)
2025-10-25 18:56:36,805 DEBUG Performing request to https://web-api.tp.entsoe.eu/api with params {'documentType': 'A44', 'in_Domain': '10YNL----------L', 'out_Domain': '10YNL----------L', 'offset': 0, 'contract_MarketAgreement.type': 'A01', 'securityToken': 'e764dd40-0108-4de7-81e7-b32f7fa55d69', 'periodStart': '202510241900', 'periodEnd': '202510271900'}
2025-10-25 18:56:36,805 INFO [926c7a30] Starting collection: 2025-10-25 20:56:36.793824+02:00 to 2025-10-26 19:56:36.793824+01:00
2025-10-25 18:56:36,807 DEBUG [926c7a30] Fetching raw data...
2025-10-25 18:56:36,807 DEBUG Attempt 1/3
2025-10-25 18:56:36,807 DEBUG Fetching EnergyZero data
2025-10-25 18:56:36,807 WARNING Attempt 1 failed: TypeError: EnergyZero.__init__() got an unexpected keyword argument 'vat'
2025-10-25 18:56:36,807 INFO Retrying in 0.51 seconds...
2025-10-25 18:56:36,807 INFO [ac45d96d] Starting collection: 2025-10-25 20:56:36.793824+02:00 to 2025-10-26 19:56:36.793824+01:00
2025-10-25 18:56:36,807 DEBUG [ac45d96d] Fetching raw data...
2025-10-25 18:56:36,807 DEBUG Attempt 1/3
2025-10-25 18:56:36,807 DEBUG Fetching EPEX data from Awattar API
2025-10-25 18:56:36,807 DEBUG Starting new HTTPS connection (1): web-api.tp.entsoe.eu:443
2025-10-25 18:56:36,808 INFO [0b75daf8] Starting collection: 2025-10-25 20:56:36.793824+02:00 to 2025-10-26 19:56:36.793824+01:00
2025-10-25 18:56:36,808 DEBUG Attempt 1/3
2025-10-25 18:56:36,809 DEBUG Fetching OpenWeather data for lat=51.966472, lon=5.94009
2025-10-25 18:56:36,809 INFO [d60ee386] Starting collection: 2025-10-25 20:56:36.793824+02:00 to 2025-10-26 19:56:36.793824+01:00
2025-10-25 18:56:36,810 DEBUG [d60ee386] Fetching raw data...
2025-10-25 18:56:36,810 DEBUG Attempt 1/10
2025-10-25 18:56:36,810 DEBUG Fetching MeteoServer weather for lat=51.966472, lon=5.94009
2025-10-25 18:56:36,810 INFO [f50f39cd] Starting collection: 2025-10-25 20:56:36.793824+02:00 to 2025-10-26 19:56:36.793824+01:00
2025-10-25 18:56:36,810 DEBUG [f50f39cd] Fetching raw data...
2025-10-25 18:56:36,810 DEBUG Attempt 1/10
2025-10-25 18:56:36,811 DEBUG Fetching MeteoServer sun forecast for lat=51.966472, lon=5.94009
2025-10-25 18:56:36,811 INFO [c5341a59] Starting collection: 2025-10-25 20:56:36.793824+02:00 to 2025-10-26 19:56:36.793824+01:00
2025-10-25 18:56:36,811 DEBUG [c5341a59] Fetching raw data...
2025-10-25 18:56:36,811 DEBUG Attempt 1/3
2025-10-25 18:56:36,811 DEBUG Fetching Elspot data for NL
2025-10-25 18:56:36,812 INFO [b2ece565] Starting collection: 2025-10-24 20:56:36.793824+02:00 to 2025-10-25 20:56:36.793824+02:00
2025-10-25 18:56:36,812 DEBUG [b2ece565] Fetching raw data...
2025-10-25 18:56:36,813 DEBUG Attempt 1/3
2025-10-25 18:56:36,813 DEBUG Fetching Luchtmeetnet data for lat=51.966472, lon=5.94009
2025-10-25 18:56:36,813 INFO Station cache miss or expired, fetching fresh data
2025-10-25 18:56:36,813 DEBUG Fetching station list
2025-10-25 18:56:36,813 DEBUG Starting new HTTPS connection (1): dataportal-api.nordpoolgroup.com:443
2025-10-25 18:56:37,010 DEBUG Parsed 8 data points from OpenWeather response
2025-10-25 18:56:37,011 INFO [0b75daf8] Collection complete: 8 data points in 0.20s (status: success)
2025-10-25 18:56:37,136 DEBUG [ac45d96d] Parsing response...
2025-10-25 18:56:37,137 DEBUG Parsed 23 data points from Awattar response
2025-10-25 18:56:37,137 DEBUG [ac45d96d] Normalizing timestamps...
2025-10-25 18:56:37,137 DEBUG [ac45d96d] Validating data...
2025-10-25 18:56:37,138 INFO [ac45d96d] Collection complete: 23 data points in 0.33s (status: success)
2025-10-25 18:56:37,318 DEBUG Attempt 2/3
2025-10-25 18:56:37,318 DEBUG Fetching EnergyZero data
2025-10-25 18:56:37,318 WARNING Attempt 2 failed: TypeError: EnergyZero.__init__() got an unexpected keyword argument 'vat'
2025-10-25 18:56:37,318 INFO Retrying in 1.95 seconds...
2025-10-25 18:56:37,444 DEBUG [d60ee386] Parsing response...
2025-10-25 18:56:37,444 DEBUG Parsed 24 data points from MeteoServer weather response
2025-10-25 18:56:37,444 DEBUG [d60ee386] Normalizing timestamps...
2025-10-25 18:56:37,445 DEBUG [d60ee386] Validating data...
2025-10-25 18:56:37,446 INFO [d60ee386] Collection complete: 24 data points in 0.64s (status: success)
2025-10-25 18:56:37,481 DEBUG https://dataportal-api.nordpoolgroup.com:443 "GET /api/DayAheadPriceIndices?currency=EUR&market=DayAhead&date=2025-10-26&resolutionInMinutes=60&indexNames=NL HTTP/1.1" 200 None
2025-10-25 18:56:37,485 DEBUG https://web-api.tp.entsoe.eu:443 "GET /api?documentType=A44&in_Domain=10YNL----------L&out_Domain=10YNL----------L&offset=0&contract_MarketAgreement.type=A01&securityToken=e764dd40-0108-4de7-81e7-b32f7fa55d69&periodStart=202510241900&periodEnd=202510271900 HTTP/1.1" 200 None
2025-10-25 18:56:37,486 DEBUG [c5341a59] Parsing response...
2025-10-25 18:56:37,487 DEBUG Parsed 21 data points from Elspot response
2025-10-25 18:56:37,487 DEBUG [c5341a59] Normalizing timestamps...
2025-10-25 18:56:37,487 DEBUG [c5341a59] Validating data...
2025-10-25 18:56:37,487 INFO [c5341a59] Collection complete: 21 data points in 0.68s (status: success)
2025-10-25 18:56:37,703 DEBUG Performing request to https://web-api.tp.entsoe.eu/api with params {'documentType': 'A44', 'in_Domain': '10YNL----------L', 'out_Domain': '10YNL----------L', 'offset': 100, 'contract_MarketAgreement.type': 'A01', 'securityToken': 'e764dd40-0108-4de7-81e7-b32f7fa55d69', 'periodStart': '202510241900', 'periodEnd': '202510271900'}
2025-10-25 18:56:37,703 DEBUG [f50f39cd] Parsing response...
2025-10-25 18:56:37,705 DEBUG Parsed 24 data points from MeteoServer sun response
2025-10-25 18:56:37,705 DEBUG [f50f39cd] Normalizing timestamps...
2025-10-25 18:56:37,705 DEBUG [f50f39cd] Validating data...
2025-10-25 18:56:37,706 INFO [f50f39cd] Collection complete: 24 data points in 0.90s (status: success)
2025-10-25 18:56:37,896 DEBUG https://web-api.tp.entsoe.eu:443 "GET /api?documentType=A44&in_Domain=10YNL----------L&out_Domain=10YNL----------L&offset=100&contract_MarketAgreement.type=A01&securityToken=e764dd40-0108-4de7-81e7-b32f7fa55d69&periodStart=202510241900&periodEnd=202510271900 HTTP/1.1" 200 933
2025-10-25 18:56:37,902 DEBUG Encoding detection: utf_8 is most likely the one.
2025-10-25 18:56:37,902 DEBUG NoMatchingDataError: for offset 100
2025-10-25 18:56:37,905 DEBUG [c1cbb326] Parsing response...
2025-10-25 18:56:37,906 DEBUG Parsed 96 data points from ENTSO-E response
2025-10-25 18:56:37,906 DEBUG [c1cbb326] Normalizing timestamps...
2025-10-25 18:56:37,906 DEBUG [c1cbb326] Validating data...
2025-10-25 18:56:37,907 INFO [c1cbb326] Collection complete: 96 data points in 1.11s (status: success)
2025-10-25 18:56:38,868 DEBUG Found 101 stations, fetching details...
2025-10-25 18:56:39,270 DEBUG Attempt 3/3
2025-10-25 18:56:39,270 DEBUG Fetching EnergyZero data
2025-10-25 18:56:39,270 WARNING Attempt 3 failed: TypeError: EnergyZero.__init__() got an unexpected keyword argument 'vat'
2025-10-25 18:56:39,270 ERROR All 3 attempts failed. Last error: TypeError: EnergyZero.__init__() got an unexpected keyword argument 'vat'
2025-10-25 18:56:39,270 ERROR [926c7a30] Collection failed after 2.47s: EnergyZero.__init__() got an unexpected keyword argument 'vat'
2025-10-25 18:57:13,547 INFO Cached 101 stations
2025-10-25 18:57:13,548 INFO Using station NL54004 (Arnhem Velperbroek)
2025-10-25 18:57:13,548 DEBUG Fetching AQI for station NL54004
2025-10-25 18:57:14,526 DEBUG Fetching measurements for station NL54004
2025-10-25 18:57:15,992 DEBUG [b2ece565] Parsing response...
2025-10-25 18:57:15,995 DEBUG Parsed 23 data points from Luchtmeetnet response
2025-10-25 18:57:15,996 DEBUG [b2ece565] Normalizing timestamps...
2025-10-25 18:57:15,996 DEBUG [b2ece565] Validating data...
2025-10-25 18:57:15,996 INFO [b2ece565] Collection complete: 23 data points in 39.18s (status: success)
2025-10-25 18:57:15,996 INFO Timestamp validation passed - all timestamps correctly formatted
2025-10-25 18:57:16,004 INFO Timestamp validation passed - all timestamps correctly formatted
2025-10-25 18:57:16,005 INFO Timestamp validation passed - all timestamps correctly formatted
2025-10-25 18:57:16,005 INFO Timestamp validation passed - all timestamps correctly formatted
