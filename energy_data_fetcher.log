2025-11-04 16:29:15,762 DEBUG Using selector: EpollSelector
2025-11-04 16:29:15,762 INFO Output directory ensured: /home/runner/work/energydatahub/energydatahub/data
2025-11-04 16:29:17,048 INFO No secrets.ini found, using environment variables only
2025-11-04 16:29:17,049 DEBUG Overriding security_keys.encryption from environment variable ENCRYPTION_KEY
2025-11-04 16:29:17,049 DEBUG Overriding security_keys.hmac from environment variable HMAC_KEY
2025-11-04 16:29:17,049 DEBUG Overriding api_keys.entsoe from environment variable ENTSOE_API_KEY
2025-11-04 16:29:17,049 DEBUG Overriding api_keys.openweather from environment variable OPENWEATHER_API_KEY
2025-11-04 16:29:17,049 DEBUG Overriding api_keys.meteo from environment variable METEO_API_KEY
2025-11-04 16:29:17,049 DEBUG Overriding api_keys.google from environment variable GOOGLE_API_KEY
2025-11-04 16:29:17,049 DEBUG Overriding api_keys.google_weather from environment variable GOOGLE_WEATHER_API_KEY
2025-11-04 16:29:17,049 INFO Initialized for 6 locations
2025-11-04 16:29:17,050 INFO [3b14d415] Starting collection: 2025-11-04 00:00:00+01:00 to 2025-11-05 23:59:59+01:00
2025-11-04 16:29:17,050 DEBUG [3b14d415] Fetching raw data...
2025-11-04 16:29:17,050 DEBUG Attempt 1/3
2025-11-04 16:29:17,050 DEBUG Fetching ENTSO-E data for NL
2025-11-04 16:29:17,050 DEBUG Querying ENTSO-E API: 2025-11-03 23:00:00+00:00 to 2025-11-05 22:59:59+00:00 (UTC)
2025-11-04 16:29:17,063 DEBUG Performing request to https://web-api.tp.entsoe.eu/api with params {'documentType': 'A44', 'in_Domain': '10YNL----------L', 'out_Domain': '10YNL----------L', 'offset': 0, 'contract_MarketAgreement.type': 'A01', 'securityToken': 'e764dd40-0108-4de7-81e7-b32f7fa55d69', 'periodStart': '202511022300', 'periodEnd': '202511062300'}
2025-11-04 16:29:17,063 INFO [c2908d7b] Starting collection: 2025-11-04 00:00:00+01:00 to 2025-11-05 23:59:59+01:00
2025-11-04 16:29:17,065 DEBUG [c2908d7b] Fetching raw data...
2025-11-04 16:29:17,065 DEBUG Attempt 1/3
2025-11-04 16:29:17,065 DEBUG Fetching EnergyZero data
2025-11-04 16:29:17,065 DEBUG Starting new HTTPS connection (1): web-api.tp.entsoe.eu:443
2025-11-04 16:29:17,067 INFO [16815e5c] Starting collection: 2025-11-04 00:00:00+01:00 to 2025-11-05 23:59:59+01:00
2025-11-04 16:29:17,067 DEBUG [16815e5c] Fetching raw data...
2025-11-04 16:29:17,067 DEBUG Attempt 1/3
2025-11-04 16:29:17,067 DEBUG Fetching EPEX data from Awattar API
2025-11-04 16:29:17,068 INFO [b524db28] Starting collection: 2025-11-04 00:00:00+01:00 to 2025-11-05 23:59:59+01:00
2025-11-04 16:29:17,068 DEBUG Attempt 1/3
2025-11-04 16:29:17,068 DEBUG Fetching OpenWeather data for lat=51.966472, lon=5.94009
2025-11-04 16:29:17,069 INFO [fe7e03f0] Starting collection: 2025-11-04 00:00:00+01:00 to 2025-11-14 00:00:00+01:00
2025-11-04 16:29:17,069 DEBUG [fe7e03f0] Fetching raw data...
2025-11-04 16:29:17,069 DEBUG Attempt 1/3
2025-11-04 16:29:17,069 INFO Fetching weather for 6 locations in parallel
2025-11-04 16:29:17,069 INFO [3f4936f6] Starting collection: 2025-11-04 00:00:00+01:00 to 2025-11-05 23:59:59+01:00
2025-11-04 16:29:17,070 DEBUG [3f4936f6] Fetching raw data...
2025-11-04 16:29:17,070 DEBUG Attempt 1/10
2025-11-04 16:29:17,070 DEBUG Fetching MeteoServer weather for lat=51.966472, lon=5.94009
2025-11-04 16:29:17,070 INFO [1725b25d] Starting collection: 2025-11-04 00:00:00+01:00 to 2025-11-05 23:59:59+01:00
2025-11-04 16:29:17,070 DEBUG [1725b25d] Fetching raw data...
2025-11-04 16:29:17,071 DEBUG Attempt 1/10
2025-11-04 16:29:17,071 DEBUG Fetching MeteoServer sun forecast for lat=51.966472, lon=5.94009
2025-11-04 16:29:17,071 INFO [ea49eb4c] Starting collection: 2025-11-04 00:00:00+01:00 to 2025-11-05 23:59:59+01:00
2025-11-04 16:29:17,072 DEBUG [ea49eb4c] Fetching raw data...
2025-11-04 16:29:17,072 DEBUG Attempt 1/3
2025-11-04 16:29:17,072 DEBUG Fetching Elspot data for NL
2025-11-04 16:29:17,072 INFO [65f26638] Starting collection: 2025-11-03 00:00:00+01:00 to 2025-11-04 00:00:00+01:00
2025-11-04 16:29:17,072 DEBUG [65f26638] Fetching raw data...
2025-11-04 16:29:17,072 DEBUG Attempt 1/3
2025-11-04 16:29:17,072 DEBUG Fetching Luchtmeetnet data for lat=51.966472, lon=5.94009
2025-11-04 16:29:17,072 INFO Station cache miss or expired, fetching fresh data
2025-11-04 16:29:17,072 DEBUG Fetching station list
2025-11-04 16:29:17,072 DEBUG Fetching Google Weather data for Hamburg_DE
2025-11-04 16:29:17,073 DEBUG Fetching Google Weather data for Munich_DE
2025-11-04 16:29:17,073 DEBUG Fetching Google Weather data for Arnhem_NL
2025-11-04 16:29:17,073 DEBUG Fetching Google Weather data for IJmuiden_NL
2025-11-04 16:29:17,073 DEBUG Fetching Google Weather data for Brussels_BE
2025-11-04 16:29:17,074 DEBUG Fetching Google Weather data for Esbjerg_DK
2025-11-04 16:29:17,167 DEBUG Starting new HTTPS connection (1): dataportal-api.nordpoolgroup.com:443
2025-11-04 16:29:17,261 DEBUG Parsed 10 data points from OpenWeather response
2025-11-04 16:29:17,262 INFO [b524db28] Collection complete: 10 data points in 0.19s (status: success)
2025-11-04 16:29:17,274 DEBUG [16815e5c] Parsing response...
2025-11-04 16:29:17,274 DEBUG Parsed 47 data points from Awattar response
2025-11-04 16:29:17,274 DEBUG [16815e5c] Normalizing timestamps...
2025-11-04 16:29:17,274 DEBUG [16815e5c] Validating data...
2025-11-04 16:29:17,275 INFO [16815e5c] Collection complete: 47 data points in 0.21s (status: success)
2025-11-04 16:29:17,305 DEBUG Successfully fetched 0 hours for Brussels_BE
2025-11-04 16:29:17,309 DEBUG Successfully fetched 0 hours for IJmuiden_NL
2025-11-04 16:29:17,340 DEBUG Successfully fetched 0 hours for Arnhem_NL
2025-11-04 16:29:17,345 DEBUG Successfully fetched 0 hours for Esbjerg_DK
2025-11-04 16:29:17,351 DEBUG Successfully fetched 0 hours for Hamburg_DE
2025-11-04 16:29:17,352 DEBUG Successfully fetched 0 hours for Munich_DE
2025-11-04 16:29:17,352 DEBUG [fe7e03f0] Parsing response...
2025-11-04 16:29:17,352 DEBUG [fe7e03f0] Normalizing timestamps...
2025-11-04 16:29:17,352 WARNING Failed to normalize timestamp 'Hamburg_DE': Invalid isoformat string: 'Hamburg_DE'. Keeping original.
2025-11-04 16:29:17,352 WARNING Failed to normalize timestamp 'Munich_DE': Invalid isoformat string: 'Munich_DE'. Keeping original.
2025-11-04 16:29:17,352 WARNING Failed to normalize timestamp 'Arnhem_NL': Invalid isoformat string: 'Arnhem_NL'. Keeping original.
2025-11-04 16:29:17,352 WARNING Failed to normalize timestamp 'IJmuiden_NL': Invalid isoformat string: 'IJmuiden_NL'. Keeping original.
2025-11-04 16:29:17,352 WARNING Failed to normalize timestamp 'Brussels_BE': Invalid isoformat string: 'Brussels_BE'. Keeping original.
2025-11-04 16:29:17,352 WARNING Failed to normalize timestamp 'Esbjerg_DK': Invalid isoformat string: 'Esbjerg_DK'. Keeping original.
2025-11-04 16:29:17,352 DEBUG [fe7e03f0] Validating data...
2025-11-04 16:29:17,352 WARNING [fe7e03f0] Found 6 malformed timestamps
2025-11-04 16:29:17,352 WARNING [fe7e03f0]   Malformed: Hamburg_DE
2025-11-04 16:29:17,352 WARNING [fe7e03f0]   Malformed: Munich_DE
2025-11-04 16:29:17,353 WARNING [fe7e03f0]   Malformed: Arnhem_NL
2025-11-04 16:29:17,353 INFO [fe7e03f0] Collection complete: 6 data points in 0.28s (status: partial)
2025-11-04 16:29:17,499 DEBUG https://web-api.tp.entsoe.eu:443 "GET /api?documentType=A44&in_Domain=10YNL----------L&out_Domain=10YNL----------L&offset=0&contract_MarketAgreement.type=A01&securityToken=e764dd40-0108-4de7-81e7-b32f7fa55d69&periodStart=202511022300&periodEnd=202511062300 HTTP/1.1" 200 None
2025-11-04 16:29:17,603 DEBUG https://dataportal-api.nordpoolgroup.com:443 "GET /api/DayAheadPriceIndices?currency=EUR&market=DayAhead&date=2025-11-05&resolutionInMinutes=60&indexNames=NL HTTP/1.1" 200 None
2025-11-04 16:29:17,607 DEBUG [ea49eb4c] Parsing response...
2025-11-04 16:29:17,608 DEBUG Parsed 24 data points from Elspot response
2025-11-04 16:29:17,608 DEBUG [ea49eb4c] Normalizing timestamps...
2025-11-04 16:29:17,608 DEBUG [ea49eb4c] Validating data...
2025-11-04 16:29:17,608 INFO [ea49eb4c] Collection complete: 24 data points in 0.54s (status: success)
2025-11-04 16:29:17,612 DEBUG [3f4936f6] Parsing response...
2025-11-04 16:29:17,612 DEBUG Parsed 30 data points from MeteoServer weather response
2025-11-04 16:29:17,612 DEBUG [3f4936f6] Normalizing timestamps...
2025-11-04 16:29:17,613 DEBUG [3f4936f6] Validating data...
2025-11-04 16:29:17,614 INFO [3f4936f6] Collection complete: 30 data points in 0.54s (status: success)
2025-11-04 16:29:17,652 DEBUG [c2908d7b] Parsing response...
2025-11-04 16:29:17,653 DEBUG Parsed 47 data points from EnergyZero response
2025-11-04 16:29:17,653 DEBUG [c2908d7b] Normalizing timestamps...
2025-11-04 16:29:17,653 DEBUG [c2908d7b] Validating data...
2025-11-04 16:29:17,658 INFO [c2908d7b] Collection complete: 47 data points in 0.60s (status: success)
2025-11-04 16:29:17,674 DEBUG Performing request to https://web-api.tp.entsoe.eu/api with params {'documentType': 'A44', 'in_Domain': '10YNL----------L', 'out_Domain': '10YNL----------L', 'offset': 100, 'contract_MarketAgreement.type': 'A01', 'securityToken': 'e764dd40-0108-4de7-81e7-b32f7fa55d69', 'periodStart': '202511022300', 'periodEnd': '202511062300'}
2025-11-04 16:29:17,837 DEBUG https://web-api.tp.entsoe.eu:443 "GET /api?documentType=A44&in_Domain=10YNL----------L&out_Domain=10YNL----------L&offset=100&contract_MarketAgreement.type=A01&securityToken=e764dd40-0108-4de7-81e7-b32f7fa55d69&periodStart=202511022300&periodEnd=202511062300 HTTP/1.1" 200 933
2025-11-04 16:29:17,844 DEBUG Encoding detection: utf_8 is most likely the one.
2025-11-04 16:29:17,844 DEBUG NoMatchingDataError: for offset 100
2025-11-04 16:29:17,846 DEBUG [3b14d415] Parsing response...
2025-11-04 16:29:17,848 DEBUG Parsed 192 data points from ENTSO-E response
2025-11-04 16:29:17,848 DEBUG [3b14d415] Normalizing timestamps...
2025-11-04 16:29:17,849 DEBUG [3b14d415] Validating data...
2025-11-04 16:29:17,849 INFO [3b14d415] Collection complete: 192 data points in 0.80s (status: success)
2025-11-04 16:29:18,068 DEBUG [1725b25d] Parsing response...
2025-11-04 16:29:18,069 DEBUG Parsed 30 data points from MeteoServer sun response
2025-11-04 16:29:18,069 DEBUG [1725b25d] Normalizing timestamps...
2025-11-04 16:29:18,069 DEBUG [1725b25d] Validating data...
2025-11-04 16:29:18,070 INFO [1725b25d] Collection complete: 30 data points in 1.00s (status: success)
2025-11-04 16:29:20,417 DEBUG Found 101 stations, fetching details...
2025-11-04 16:30:05,959 INFO Cached 101 stations
2025-11-04 16:30:05,959 INFO Using station NL54004 (Arnhem Velperbroek)
2025-11-04 16:30:05,959 DEBUG Fetching AQI for station NL54004
2025-11-04 16:30:07,640 DEBUG Fetching measurements for station NL54004
2025-11-04 16:30:10,004 DEBUG [65f26638] Parsing response...
2025-11-04 16:30:10,007 DEBUG Parsed 24 data points from Luchtmeetnet response
2025-11-04 16:30:10,007 DEBUG [65f26638] Normalizing timestamps...
2025-11-04 16:30:10,007 DEBUG [65f26638] Validating data...
2025-11-04 16:30:10,008 INFO [65f26638] Collection complete: 24 data points in 52.94s (status: success)
2025-11-04 16:30:10,008 INFO Timestamp validation passed - all timestamps correctly formatted
2025-11-04 16:30:10,017 INFO Timestamp validation passed - all timestamps correctly formatted
2025-11-04 16:30:10,018 INFO Timestamp validation passed - all timestamps correctly formatted
2025-11-04 16:30:10,018 INFO Saved multi-location weather forecast for 6 locations
2025-11-04 16:30:10,018 INFO Timestamp validation passed - all timestamps correctly formatted
2025-11-04 16:30:10,019 INFO Timestamp validation passed - all timestamps correctly formatted
